<h3 ng-bind="title"></h3>
<hr/>

<form novalidate name="userForm">
    <div class="row">
        <div class="form-group col-md-3">
            <label>Логин</label>
            <input ng-disabled="user.id!=0" required ng-maxlength="20" class="form-control" type="text" name="login"
                   ng-model="user.login"/>
            <span ng-show="userForm.login.$error.maxlength" class="text-warning">Не более 20 символов</span>
        </div>
        <div class="form-group col-md-3">
            <label>Пароль</label>
            <input required ng-maxlength="40" class="form-control" type="text" name="password"
                   ng-model="user.password"/>
            <span ng-show="userForm.password.$error.maxlength" class="text-warning">Не более 20 символов</span>
        </div>
    </div>
    <hr/>
    <div class="row">
        <div class="form-group col-md-3">
            <label>Фамилия</label>
            <input class="form-control" type="text" name="lastName" ng-model="user.lastName" required
                   ng-maxlength="40"/>
            <span ng-show="userForm.lastName.$error.maxlength" class="text-warning">Не более 40 символов</span>
        </div>
        <div class="form-group col-md-3">
            <label>Имя</label>
            <input class="form-control" type="text" name="firstName" ng-model="user.firstName" required
                   ng-maxlength="25"/>
            <span ng-show="userForm.firstName.$error.maxlength" class="text-warning">Не более 25 символов</span>
        </div>
        <div class="form-group col-md-3">
            <label>Отчетсво</label>
            <input class="form-control" type="text" name="middleName" ng-model="user.middleName" required
                   ng-maxlength="25"/>
            <span ng-show="userForm.middleName.$error.maxlength" class="text-warning">Не более 25 символов</span>
        </div>
    </div>
    <hr/>
    <div class="row">
        <div class="form-group col-md-3">
            <label>Компания</label>
            <input class="form-control" type="text" name="companyTitle" ng-model="user.companyTitle"
                   ng-maxlength="100"/>
            <span ng-show="userForm.companyTitle.$error.maxlength" class="text-warning">Не более 100 символов</span>
        </div>
        <div class="form-group col-md-3">
            <label>Должность</label>
            <input class="form-control" type="text" name="position" ng-model="user.position" ng-maxlength="100"/>
            <span ng-show="userForm.position.$error.maxlength" class="text-warning">Не более 100 символов</span>
        </div>
    </div>
    <hr/>
    <div class="row">
        <div class="form-group col-md-3">
            <label>E-mail</label>
            <input class="form-control" type="text" name="email" ng-model="user.email" ng-maxlength="55"/>
            <span ng-show="userForm.email.$error.maxlength" class="text-warning">Не более 55 символов</span>
        </div>
        <div class="form-group col-md-3">
            <label>Телефон</label>
            <input class="form-control" type="text" name="phone" ng-model="user.phone" ng-maxlength="15"/>
            <span ng-show="userForm.phone.$error.maxlength" class="text-warning">Не более 15 символов</span>
        </div>
    </div>
    <hr/>
    <div class="row">
        <div class="form-group col-md-3">
            <label>Роли</label>
            <div class="checkbox" name="roles" ng-repeat="r in roles">
                <label>
                    <input ng-change="checkboxChanged()" type="checkbox" name="role"
                           checklist-model="user.roles" checklist-value="r" ng-model="checked"
                           checklist-change="userForm.role.$setValidity('required', user.roles.length > 0)">
                    {{r}}
                </label>
            </div>
        </div>
    </div>
    <hr/>
    <div class="row">
        <div class="form-group col-xs-12 col-sm-8 col-md-4">
            <button class="btn btn-success" type="button"
                    ng-show="(user.id==0&&!userForm.$invalid&&user.roles.length>0)||(user.id!=0&&!userForm.$invalid&&userForm.$dirty&&user.roles.length>0)"
                    ng-click="saveUser(user, userForm)">Сохранить
            </button>
            <button class="btn btn-danger" type="button"
                    ng-show="userForm.$dirty" ng-click="resetUser(userForm)">Сбросить
            </button>
            <a ui-sref="users" class="btn btn-default">Назад</a>
        </div>
    </div>
</form>